(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{192:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c});var a=n(49),r=function(e,t,n,a){for(var r=[],c=e.find(function(e){return e[t]===a}),o=function(e){return e[t]===c[n]};void 0!==c&&void 0!==c[n];)r.push(c),c=e.find(o);return void 0!==c&&r.push(c),r},c=function(e){return Object.keys(e).map(function(t){return Object(a.a)({},t,e[t].trim())}).reduce(function(e,t){return Object.assign({},e,t)},{})}},287:function(e,t,n){"use strict";n.r(t);var a=n(185),r=n(55),c=n(0),o=n.n(c),i=n(56),l=n.n(i),u=n(210),d=n(170),s=n(125),m=n(246),f=n.n(m),E=Object(s.a)(function(e){return{striped:{"& tbody tr:nth-of-type(odd)":{backgroundColor:f.a[100]}}}}),w=function(e){var t=E();return o.a.createElement(d.f.Table,Object.assign({},e,{className:t.striped}))},p=n(72),h=n(169),b=n(247),v=n.n(b),g=n(248),j=n.n(g),C=n(84),O=n(286),x=Object(s.a)(function(e){return{cell:{padding:0},duplicate:{paddingLeft:"8px !important",backgroundColor:v.a[50],width:"100%",height:"100%"},pointed:{paddingLeft:"8px !important",backgroundColor:j.a[50],width:"100%",height:"100%"},button:{width:"100%",height:"100%"}}}),k=function(e){var t=e.onDuplicateCellClick,n=Object(p.a)(e,["onDuplicateCellClick"]),a=x();return o.a.createElement(h.l,null,function(e){var r=e.tableBodyRows,c=e.pointer;if(r.map(function(e){return e.row}).filter(function(e){return e.id!==n.row.id}).map(function(e){return e[n.column.name]}).includes(n.value)){var i=n.row.id===c;return o.a.createElement(O.a,{className:a.cell},o.a.createElement(C.a,{className:a.button,onClick:function(){return t(n.column.name,n.value)}},o.a.createElement(d.f.Cell,Object.assign({},n,{className:i?a.pointed:a.duplicate}))))}return o.a.createElement(d.f.Cell,n)})},R=n(249),y=n.n(R),S=Object(s.a)(function(e){return{pointed:{backgroundColor:"".concat(y.a[50]," !important")}}}),I=function(e){var t=e.tableRow,n=S();return o.a.createElement(h.l,null,function(a,r){var c=a.pointer,i=r.changePointer;return c===t.rowId?o.a.createElement(d.f.Row,Object.assign({},e,{className:n.pointed})):o.a.createElement(d.f.Row,Object.assign({},e,{onClick:function(){return i(t.rowId)}}))})},D=n(156),N=n(213),P=n.n(N),B=n(158),L=n(160),A=Object(s.a)(function(e){return{border:{borderBottom:"1px solid rgba(224, 224, 224, 1)"},root:{width:"100%",borderBottom:0},closeButton:{width:"48px",height:"48px"}}}),F=function(e){var t=A(),n=e.onFilter;return o.a.createElement("th",{className:t.border},o.a.createElement(B.a,{display:"flex",flexDirection:"row",alignItems:"center"},o.a.createElement(B.a,{display:"flex",flexGrow:1},o.a.createElement(d.d.Cell,Object.assign({},e,{className:t.root}))),o.a.createElement(L.a,{title:"\u6e05\u9664\u67e5\u8a62"},o.a.createElement(D.a,{onClick:function(){return n(null)},className:t.closeButton},o.a.createElement(P.a,null)))))},G=n(49),J=n(62),q=n.n(J),T=n(279),U=Object(s.a)(function(e){return{inputRoot:{width:"100%"},inputRight:{textAlign:"right"},inputCenter:{textAlign:"center"}}}),V=function(e){var t,n=U(),a=e.value,r=e.editingEnabled,c=e.onValueChange,i=e.column,l=e.tableColumn,u=q()((t={},Object(G.a)(t,n.inputRight,l&&"right"===l.align),Object(G.a)(t,n.inputCenter,l&&"center"===l.align),t));return o.a.createElement(d.c.Cell,e,o.a.createElement(T.a,{multiline:!0,className:n.inputRoot,classes:{input:u},value:a||"",disabled:!r,onChange:function(e){return c(e.target.value)},autoFocus:r&&"key"===i.name}))},z=n(184),H=n.n(z),K=n(250),M=n.n(K),Q=n(251),W=n.n(Q),X=n(252),Y=n.n(X),Z=n(253);function $(e){var t=[],n=function(n){var a=n.key;t=Object(Z.a)(t,[a]),e(t,n)},a=function(e){var n=e.key;t=t.filter(function(e){return e!==n})};return Object(c.useEffect)(function(){return window.addEventListener("keydown",n),window.addEventListener("keyup",a),function(){window.removeEventListener("keydown",n),window.removeEventListener("keyup",a)}}),t}var _=function(e){var t=e.onExecute;return o.a.createElement(L.a,{title:"\u65b0\u589e\u4e00\u689d\u7ffb\u8b6f(\u5feb\u901f\u9375\uff1aShift + n)"},o.a.createElement(D.a,{onClick:t},o.a.createElement(H.a,null)))},ee=function(e){var t=e.onExecute;return o.a.createElement(L.a,{title:"\u4fee\u6539(\u5feb\u901f\u9375\uff1aShift + e)"},o.a.createElement(D.a,{onClick:t},o.a.createElement(M.a,null)))},te=function(e){var t=e.onExecute;return o.a.createElement(L.a,{title:"\u522a\u9664(\u5feb\u901f\u9375\uff1aShift + Delete)"},o.a.createElement(D.a,{onClick:t},o.a.createElement(W.a,null)))},ne=function(e){var t=e.onExecute;return $(function(e){e.includes("Shift")&&e.includes("Enter")&&t()}),o.a.createElement(L.a,{title:"\u5132\u5b58(\u5feb\u901f\u9375\uff1aShift + Enter)"},o.a.createElement(D.a,{onClick:t},o.a.createElement(Y.a,null)))},ae=function(e){var t=e.onExecute;return $(function(e){e.includes("Escape")&&t()}),o.a.createElement(L.a,{title:"\u53d6\u6d88(\u5feb\u901f\u9375\uff1aEsc)"},o.a.createElement(D.a,{onClick:t},o.a.createElement(P.a,null)))},re=function(e){var t=e.id,n=e.onExecute,a={add:_,edit:ee,delete:te,commit:ne,cancel:ae}[t];return o.a.createElement(a,{onExecute:n})},ce=function(e){var t=e.pointer,n=e.onPointerChange;return o.a.createElement(h.g,null,o.a.createElement(h.f,{name:"pointer",value:t}),o.a.createElement(h.a,{name:"changePointer",action:n}))},oe=function(e){var t=e.pointer,n=e.tableBodyRows,a=e.editingRowIds,r=e.changePointer,c=e.addRow,o=e.startEditRows,i=e.deleteRows,l=e.commitDeletedRows;return $(function(e,u){var d=n.findIndex(function(e){return e.row.id===t});if(0===a.length){if(e.includes("Shift")&&(e.includes("N")||e.includes("n")))return c(),void u.preventDefault();if(e.includes("Shift")&&(e.includes("E")||e.includes("e"))&&-1!==d)return o({rowIds:[t]}),void u.preventDefault();if(e.includes("Shift")&&e.includes("Delete")&&-1!==d){var s=n.length;return i({rowIds:[t]}),l({rowIds:[t]}),void r(d===s-1?n[0].row.id:n[d+1].row.id)}e.includes("ArrowUp")?r(d<0?n[0].row.id:0===d?n[n.length-1].row.id:n[d-1].row.id):e.includes("ArrowDown")&&(d<0||d===n.length-1?r(n[0].row.id):r(n[d+1].row.id))}}),null},ie=function(){return o.a.createElement(h.g,null,o.a.createElement(h.l,null,function(e,t){var n=e.pointer,a=e.tableBodyRows,r=e.editingRowIds,c=t.changePointer,i=t.addRow,l=t.startEditRows,u=t.deleteRows,d=t.commitDeletedRows;return o.a.createElement(oe,{pointer:n,tableBodyRows:a,editingRowIds:r,changePointer:c,addRow:i,startEditRows:l,deleteRows:u,commitDeletedRows:d})}))},le=n(176),ue=n.n(le),de=n(181),se=n(192),me=n(35),fe=n(57),Ee=function(){var e=l()(),t=e.match,n=e.history,i=Object(me.a)(),s=Object(c.useState)(!0),m=Object(r.a)(s,2),f=m[0],E=m[1],p=Object(c.useState)({}),h=Object(r.a)(p,2),b=h[0],v=h[1],g=Object(c.useState)({start:"",languages:[],rows:{},metas:{}}),j=Object(r.a)(g,2),C=j[0],O=j[1],x=Object(c.useState)(),R=Object(r.a)(x,2),y=R[0],S=R[1],D=Object(c.useState)(),N=Object(r.a)(D,2),P=N[0],B=N[1],L=Object(c.useState)([]),A=Object(r.a)(L,2),G=A[0],J=A[1],q=Object(c.useState)(),T=Object(r.a)(q,2),U=T[0],z=T[1];Object(c.useEffect)(function(){var e=i.refGroup({id:t.params.groupId}).child("projects/".concat(t.params.projectId));return e.on("value",function(e){e.exists()?v(e.val()):n.push("/no-content")}),void 0===y&&S(e),function(){void 0!==y&&y.off()}},[y]),Object(c.useEffect)(function(){var e=i.refProjectContents({id:t.params.projectId});return e.on("value",function(e){e.exists()||O({start:"",languages:[],rows:{},metas:{}}),O(e.val()),E(!1)}),void 0===P&&B(e),function(){void 0!==P&&P.off()}},[P]);var H=["key"].concat(C.languages).map(function(e){return{name:e,title:e}}),K=Object(se.a)(Object.values(C.metas||{}),"id","next",C.start).map(function(e){return C.rows[e.id]}),M=function(e,t){return J([{columnName:e,operation:"equal",value:t}])};return f?o.a.createElement(fe.a,null):o.a.createElement(d.a,{rows:K,columns:H,getRowId:function(e){return e.id}},o.a.createElement(ce,{pointer:U,onPointerChange:z}),o.a.createElement(u.c,{onCommitChanges:function(e){var t=e.added,n=e.changed,r=e.deleted,c=i.refProjectContents({id:b.id});if(t&&Object(de.a)(t.concat(K).map(function(e){return Object(se.b)(e)}),"key").forEach(function(e,t,n){void 0===e.id&&(e.id=ue()(),c.child("rows/".concat(e.id)).set(e),0===t?c.child("start").set(e.id):c.child("metas/".concat(n[t-1].id,"/next")).set(e.id),t===n.length-1?c.child("metas/".concat(e.id)).set({id:e.id,canExport:!0}):c.child("metas/".concat(e.id)).set({id:e.id,canExport:!0,next:n[t+1].id||""}))}),n&&K.forEach(function(e){n[e.id]&&c.child("rows/".concat(e.id)).set(Object(a.a)({},e,n[e.id]))}),r){var o=new Set(r);K.forEach(function(e,t,n){if(o.has(e.id))if(0===t)c.child("start").set(C.metas[e.id].next||"").then(function(){c.child("rows/".concat(e.id)).remove(),c.child("metas/".concat(e.id)).remove()});else{var a=n[t-1].id;c.child("metas/".concat(a,"/next")).set(C.metas[e.id].next||"").then(function(){c.child("rows/".concat(e.id)).remove(),c.child("metas/".concat(e.id)).remove()})}})}}}),o.a.createElement(u.d,{filters:G,onFiltersChange:J}),o.a.createElement(u.g,null),o.a.createElement(d.f,{height:840,tableComponent:w,cellComponent:function(e){return o.a.createElement(k,Object.assign({onDuplicateCellClick:M},e))},rowComponent:I}),o.a.createElement(d.e,null),o.a.createElement(d.d,{showFilterSelector:!0,cellComponent:F}),o.a.createElement(d.c,{cellComponent:V}),o.a.createElement(d.b,{showAddCommand:!0,showEditCommand:!0,showDeleteCommand:!0,commandComponent:re}),o.a.createElement(ie,null))};n.d(t,"default",function(){return Ee})}}]);
//# sourceMappingURL=8.7ade3f7b.chunk.js.map